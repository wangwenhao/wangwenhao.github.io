<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT, 前端开发, JavaScript, CSS, HTML" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta property="og:type" content="website">
<meta property="og:title" content="wenhao's notes">
<meta property="og:url" content="http://wangwenhao.github.io/index.html">
<meta property="og:site_name" content="wenhao's notes">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="wenhao's notes">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>




  <link rel="canonical" href="http://wangwenhao.github.io/"/>

  <title> wenhao's notes </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">wenhao's notes</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/21/writing-better-css-with-currentcolor/" itemprop="url">
                  【译】使用 currentColor 属性写出更好的 CSS 代码
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-09-21T15:44:06+08:00" content="2016-09-21">
              2016-09-21
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="https://hashnode.com/post/writing-better-css-with-currentcolor-cit5mgva31co79c53ia20vetq" target="_blank" rel="external">原文地址</a></p>
<p>有一些极其强大的 CSS 属性有着很好的浏览器支持，但是开发者们却极少用到。<code>currentColor</code> 就是其中之一。</p>
<p>MDN defines currentColor as</p>
<p>在 MDN 上对 currentColor 是这么<a href="https://developer.mozilla.org/en/docs/Web/CSS/color_value#currentColor_keyword" target="_blank" rel="external">定义</a>的。</p>
<blockquote>
<p>The currentColor keyword represents the calculated value of the element’s color property. It allows to make the color properties inherited by properties or child’s element properties that do not inherit it by default.</p>
<p><code>currentColor</code> 关键字表示了元素的颜色属性的计算值。它可以使元素的属性中使用颜色的时候继承本身的 <code>color</code> 属性，或者子元素可以从父元素继承颜色属性。简言之，它改变了元素的默认继承属性。</p>
</blockquote>
<p>In this article, let’s get an overview on how to use CSS currentColor keyword in some interesting ways.</p>
<p>在这篇文章里，我们来看看如何来使用 CSS 的 <code>currentColor</code> 关键字。有很多很有趣的方式。</p>
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p><code>currentColor</code> 关键字获取 <code>color</code> 属性中的颜色值，把它保存在自身的一个规则里。</p>
<p>当你想继承使用 <code>color</code> 属性中的颜色值的时候，就可以用 <code>currentColor</code> 关键字。如此一来，当你修改了 <code>color</code> 属性的值，所有用 <code>currentColor</code> 关键字来引用这个颜色值的地方都会相应的自动修改。是不是很棒？</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">.box &#123;</div><div class="line">    color: red;</div><div class="line">    border 1px solid currentColor;</div><div class="line">    box-shadow: 0 0 2px 2px currentColor;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>在上面的代码中，可以看到我们没有到处重复使用相同的颜色值，而是使用 <code>currentColor</code> 关键字。这样带来的好处就是使得 CSS 变得更好维护了，我们不需要再到处去维护颜色值了。</p>
<h2 id="可能的用法"><a href="#可能的用法" class="headerlink" title="可能的用法"></a>可能的用法</h2><p>让我们来看看一些 <code>currentColor</code> 的用例和例子。</p>
<h3 id="简化颜色定义"><a href="#简化颜色定义" class="headerlink" title="简化颜色定义"></a>简化颜色定义</h3><p>像链接，边框，图标和阴影经常会使用和他们父元素相同的颜色，用 <code>currentColor</code> 值来表示颜色值避免了在很多地方去用各自的颜色值，从而提高代码的可维护性。</p>
<p>举个例子：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">.box &#123;</div><div class="line">    color: red;</div><div class="line">&#125;</div><div class="line">.box .child-1 &#123;</div><div class="line">    background: currentColor;</div><div class="line">&#125;</div><div class="line">.box .child-2 &#123;</div><div class="line">    color: currentColor;</div><div class="line">    border 1px solid currentColor;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>在上面的代码段中，可以看见没有给 <code>background</code>、<code>border</code> 属性指定某个颜色，而是用 <code>currentColor</code> 来代替。这样一来，它们就都是红色了。</p>
<h3 id="简化过渡和动画"><a href="#简化过渡和动画" class="headerlink" title="简化过渡和动画"></a>简化过渡和动画</h3><p><code>currentColor</code> 能让过渡和动画变得更简单。</p>
<p>让我们来看一下之前的一个例子，增加改变悬停的颜色的效果。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.box</span><span class="selector-pseudo">:hover</span> &#123;</div><div class="line">    <span class="attribute">color</span>: purple;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>在这里，没有在 <code>:hover</code> 里重新定义三个颜色值，而只是修改了 <code>color</code> 属性的值。所有使用了 <code>currentColor</code> 的属性都会在有悬停的时候自动应用这个修改。</p>
<h3 id="在伪元素中的应用"><a href="#在伪元素中的应用" class="headerlink" title="在伪元素中的应用"></a>在伪元素中的应用</h3><p>类似 <code>:before</code> 和 <code>:after</code> 这样的伪元素也会从它们的与元素继承 <code>currentColor</code> 的值。这可以应用在诸如有动态颜色的提示（tooltips），覆盖层（overlays），还可以给它加上一个具有透明度的效果。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.box</span> &#123;</div><div class="line">    <span class="attribute">color</span>: red;</div><div class="line">&#125;</div><div class="line"><span class="selector-class">.box</span><span class="selector-pseudo">:before</span> &#123;</div><div class="line">    <span class="attribute">color</span>: currentColor;</div><div class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid currentColor;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>在这段代码里，<code>:before</code> 伪元素继承了父元素的颜色值，将父元素的值用在了 <code>color</code> 和 <code>border-color</code> 上，用这个机制，可以实现像 tooltips 之类的东西。</p>
<h3 id="和-SVG-配合使用"><a href="#和-SVG-配合使用" class="headerlink" title="和 SVG 配合使用"></a>和 SVG 配合使用</h3><p>SVG 也可以从父元素里获取 <code>currentColor</code> 的值。当在不同的地方使用这个 SVG 的时候，如果想要直接继承所在父元素的颜色而不想每次都都指定，这真的是一个很有用的方法。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">svg</span> &#123;</div><div class="line">    <span class="attribute">fill</span>: currentColor;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>在这个例子中， svg 和它的父元素会有相同的填充色，也会跟着父元素的颜色的修改而动态变化。</p>
<h3 id="和渐变配合使用"><a href="#和渐变配合使用" class="headerlink" title="和渐变配合使用"></a>和渐变配合使用</h3><p><code>currentColor</code> 还可以用在渐变中，如果渐变中的一种颜色是父元素的颜色的话，是很方便的。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.box</span> &#123;</div><div class="line">    <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(top bottom right, currentColor, #FFFFFF);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>在上面的例子中，顶部的渐变色总是和父元素的颜色相同。虽然在这个例子中只能使用一种颜色来动态赋值，但不得不承认这是一个很巧妙的技巧来生成基于父元素颜色的动态渐变。</p>
<p>这里有一个 <a href="http://codepen.io/alkshendra/pen/xEVrJJ?editors=1100#0" target="_blank" rel="external">Codepen 上的例子</a>，演示了上面所有的用例。</p>
<h2 id="浏览器支持"><a href="#浏览器支持" class="headerlink" title="浏览器支持"></a>浏览器支持</h2><p>CSS 的 <code>currentColor</code> 属性是从 SVG 细则中引入 CSS3 的，其实它 2003 年就在存在了。因此，对于 <code>currentColor</code> 的支持已经十分广泛了，IE8 及以下版本是个例外。</p>
<p>下面这张图表是从 <a href="http://caniuse.com/#feat=currentcolor" target="_blank" rel="external">caniuse.com</a> 网站查询得到的：</p>
<p><img src="https://res.cloudinary.com/hashnode/image/upload/v1474021764/g03f4hx1ftb0frtoonfw.png" alt="currentColor 浏览器支持"></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>CSS 的 <code>currentColor</code> 属性是一个未被充分使用的强大特性。它的支持性很好，并且带来了更多的方式来让我们的代码变得更清晰。</p>
<p>由于 CSS 变量还在试验阶段，习惯使用 <code>currentColor</code> 属性绝对对你是很有帮助的。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/19/vue-2048/" itemprop="url">
                  用Vue.js简单实现2048
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-09-19T21:57:21+08:00" content="2016-09-19">
              2016-09-19
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>2048是一个喜闻乐见的游戏，最近在看 Vue，于是想用 Vue 来实现一下，结果发现并没有用到 Vue 里面的很多内容。</p>
<h2 id="游戏面板构建"><a href="#游戏面板构建" class="headerlink" title="游戏面板构建"></a>游戏面板构建</h2><p>首先，构造一个 4 * 4 的游戏面板，很简单的用 <code>ul</code> 和 <code>li</code> 来实现就可以了。<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">"game-board"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">"block in blocks"</span></span></div><div class="line">      <span class="attr">track-by</span>=<span class="string">"$index"</span></div><div class="line">      <span class="attr">v-text</span>=<span class="string">"block == 0 ? '' : block"</span></div><div class="line">      <span class="attr">:class</span>=<span class="string">"&#123;'empty': block == 0&#125;"</span>&gt;</div><div class="line">  <span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></div></pre></td></tr></table></figure></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</div><div class="line">  data() &#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      blocks: [] <span class="comment">// 储存16个格子里的数值，将在组件初始化的时候进行填充。</span></div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  methods: &#123;</div><div class="line">    render() &#123;</div><div class="line">      <span class="keyword">this</span>.blocks = [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>];</div><div class="line">    &#125;,</div><div class="line">    ready() &#123;</div><div class="line">      <span class="keyword">this</span>.render();</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*css样式我就不详细贴出来了，因为没有什么特别的。*/</span></div></pre></td></tr></table></figure>
<p>上面的代码应该一目了然吧，在生命周期方法 <code>ready</code> 里进行游戏面板的构造，当然，现在这个面板是空的，接下来需要……</p>
<h2 id="游戏初始化"><a href="#游戏初始化" class="headerlink" title="游戏初始化"></a>游戏初始化</h2><p>在2048里，游戏的初始状态是在16个格子中随机填充数字2或4，当然出现2的概率会比出现4的概率大，本着一切就简的原则，这里我们出现4的概率是0，哈哈哈。</p>
<p>这个和 Vue 也没什么关系，主要是涉及到随机数的生成，在 javascript 里用 <code>Math.random()</code> 方法生成随机数，在这里有个公式挺有用的，要取整数 n 到 m 之间的随机数可以用这样的公式：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> num = <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * (m - n)) + n;</div></pre></td></tr></table></figure>
<p>知道了这点，我们来把代码补全：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">render() &#123;</div><div class="line">  <span class="keyword">this</span>.blocks = [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>];</div><div class="line">  <span class="comment">// 游戏初始化, 将游戏面板中随机两块设置为2</span></div><div class="line">  <span class="keyword">var</span> first = <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">15</span>);</div><div class="line">  <span class="keyword">var</span> second;</div><div class="line">  <span class="keyword">do</span> &#123;</div><div class="line">    second = <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">15</span>);</div><div class="line">  &#125; <span class="keyword">while</span>(first == second);</div><div class="line"></div><div class="line">  <span class="keyword">this</span>.blocks.$set(first, <span class="number">2</span>);</div><div class="line">  <span class="keyword">this</span>.blocks.$set(second, <span class="number">2</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>这里用了一个 <code>do...while</code> 来保证生成的两个数是不相同的。</p>
<h2 id="加入事件"><a href="#加入事件" class="headerlink" title="加入事件"></a>加入事件</h2><p>本来我想偷个懒，直接用键盘的上下左右来控制事件，但是整页响应键盘事件要挂载在 <code>document</code> 对象上，太丑了。最后还有决定用手势事件来做，这里就用到了 <code>vue-touch</code> 这个库，用法很简单。</p>
<p>第一步当然是：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm i vue-touch --save</div></pre></td></tr></table></figure></p>
<p>安装好了之后和用 Vue.use() 来挂载一下。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> VueTouch <span class="keyword">from</span> <span class="string">'vue-touch'</span>;</div><div class="line">Vue.use(VueTouch);</div></pre></td></tr></table></figure></p>
<p>然后就可以在组件中使用 <code>v-touch</code> 这个指令了。</p>
<p>先把事件绑好：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">"game-board"</span> <span class="attr">v-touch:swipeleft</span>=<span class="string">"moveLeft"</span></span></div><div class="line">        <span class="attr">v-touch:swipeup</span>=<span class="string">"moveUp"</span></div><div class="line">        <span class="attr">v-touch:swiperight</span>=<span class="string">"moveRight"</span></div><div class="line">        <span class="attr">v-touch:swipedown</span>=<span class="string">"moveDown"</span>&gt;</div><div class="line">...</div><div class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h2 id="逻辑实现"><a href="#逻辑实现" class="headerlink" title="逻辑实现"></a>逻辑实现</h2><p>2048的逻辑十分简单，只要理清思路就很好做，之前我在 iOS 上也做过一次，上次是用多维数组实现的，这次用一维数组实现我觉得到是更简单了……</p>
<p>开始来写向左滑动的逻辑，先理一下思路好了：</p>
<ol>
<li>向左滑动实际上有可能产生滑动的是右边的三列，所以我们可以不考虑左边第一列</li>
<li>滑动停止的条件：<ul>
<li>遇到边框</li>
<li>遇到一个非空格子并且和里面的数字和自己的不一样</li>
</ul>
</li>
<li>如果遇到和自己一样的数字，就合并。</li>
<li>所有格子都移动完之后，在游戏面板的空格子里添加一个数字2。</li>
</ol>
<p>思路就是这样，下面看代码。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">moveLeft() &#123;</div><div class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="keyword">this</span>.blocks.length; i++) &#123;</div><div class="line">    <span class="keyword">var</span> moveTo = i;</div><div class="line">    </div><div class="line">    <span class="keyword">if</span>(i % <span class="number">4</span> == <span class="number">0</span>) <span class="keyword">continue</span>; <span class="comment">// 只操作后面三列</span></div><div class="line">    <span class="comment">// 寻找目标位置</span></div><div class="line">    <span class="keyword">while</span>(moveTo % <span class="number">4</span> != <span class="number">0</span>) &#123; <span class="comment">// 遇到边框</span></div><div class="line">      <span class="keyword">if</span>(<span class="keyword">this</span>.blocks[moveTo - <span class="number">1</span>] != <span class="number">0</span> &amp;&amp; <span class="comment">// 遇到一个非空格子</span></div><div class="line">         <span class="keyword">this</span>.blocks[moveTo - <span class="number">1</span>] != <span class="keyword">this</span>.blocks[i]) <span class="comment">//并且数字和自己的不同。</span></div><div class="line">        <span class="keyword">break</span>;</div><div class="line">      moveTo--;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">this</span>.move(i, moveTo); <span class="comment">// 移动事件</span></div><div class="line">  &#125;</div><div class="line">  <span class="keyword">this</span>.newBlock(); <span class="comment">// 添加新数字块事件</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">move(<span class="keyword">from</span>, to) &#123; </div><div class="line">  <span class="keyword">if</span>(<span class="keyword">from</span> == to) <span class="keyword">return</span>;</div><div class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.blocks[<span class="keyword">from</span>] == <span class="keyword">this</span>.blocks[to]) &#123;</div><div class="line">    <span class="keyword">this</span>.blocks.$set(to, <span class="keyword">this</span>.blocks[to] * <span class="number">2</span>);</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="keyword">this</span>.blocks.$set(to, <span class="keyword">this</span>.blocks[<span class="keyword">from</span>]);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">this</span>.blocks.$set(<span class="keyword">from</span>, <span class="number">0</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">newBlock() &#123;</div><div class="line">  <span class="keyword">var</span> newBlock;</div><div class="line">  <span class="keyword">do</span> &#123;</div><div class="line">    newBlock = <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">15</span>);</div><div class="line">  &#125; <span class="keyword">while</span>(<span class="keyword">this</span>.blocks[newBlock] != <span class="number">0</span>);</div><div class="line"></div><div class="line">  <span class="keyword">this</span>.blocks.$set(newBlock, <span class="number">2</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>可以看到真正的移动其实是在 <code>move()</code> 方法里面事件的， <code>moveLeft()</code> 方法里面只是获取到这个数字块需要移动到的位置。这样 <code>move()</code> 方法还可以被向其他方向的方法来公用。</p>
<p>好了，向左的写好了，其他方向的也就大同小异了。但是有几个需要注意的地方：</p>
<ol>
<li>上下格子的 index 相差4</li>
<li>向右和向下运动方法里面遍历数组的时候应该从后往前遍历，不然会有不可预料的结果。</li>
</ol>
<p>恩，就写到这里吧，只是一个简单的实现，没有加入分数计算和游戏结束的判断，可能明天来写一下，也有可能就不写了，因为我实在是太懒了。</p>
<p>搞了半天和 Vue 没什么关系，哈哈哈。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/09/vuex-overview/" itemprop="url">
                  Vuex 初步印象
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-09-09T23:13:36+08:00" content="2016-09-09">
              2016-09-09
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>刚刚把 Vue.js 中用于状态管理架构的 Vuex 的文档啃了一遍。</p>
<p>Vue 组件化之后各个组件都拥有自己的状态，这让状态在组件中的共享变得十分困难，通常用事件的方式把状态推送到其他组件中去，当组件树变得非常大的时候，事件流会变得非常复杂，很难维护，会 Out of Control。</p>
<p>Vuex 就是为此而诞生的，用 Vuex 来维护一个应用级的状态，它不属于任何特定的组件，组件之间可以共享这个状态。</p>
<h2 id="Vuex-数据流"><a href="#Vuex-数据流" class="headerlink" title="Vuex 数据流"></a>Vuex 数据流</h2><p>首先来看一下 Vuex 数据流的一张图，这张图画的十分清晰。</p>
<p><img src="http://vuex.vuejs.org/zh-cn/vuex.png" alt=""></p>
<p>从组件开始看，当用户对 Vue 的组件进行操作的的时候，组件会调用 <em>Actions</em>，<em>Actions</em> 顾名思义是一系列的动作，由它来决定对 <em>Store</em> 做什么操作，但是它不能直接操作 <em>State</em>，也就是上面所说的状态。按照我的理解，<em>Action</em> 作为一个通知者，把所要做的操作分发到 <em>Mutation</em>，<em>Mutation</em> 会去修改 <em>State</em>，当 <em>State</em> 发生变化会由 <em>Getter</em> 来从 <em>State</em> 里获取 Vue 组件中所需要的数据，从而更新界面。</p>
<p>看上去很麻烦的样子啊，但是这一切都是建立在我们要构建的是一个大型应用的前提之下的。目的是提高可维护性，降低调试与长期维护的难度。</p>
<p>接下来就来看一下 Vuex 中几个核心的内容：</p>
<h2 id="核心内容"><a href="#核心内容" class="headerlink" title="核心内容"></a>核心内容</h2><h3 id="State"><a href="#State" class="headerlink" title="State"></a>State</h3><p><em>State</em> 对象包含了全部的应用级状态，是一个唯一数据源。一个应用只有一个 <code>store</code> 实例。</p>
<p>不过，它是可以分模块的，就像这样：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> module1 <span class="keyword">from</span> <span class="string">'./modules/module1'</span></div><div class="line"><span class="keyword">import</span> module2 <span class="keyword">from</span> <span class="string">'./modules/module2'</span></div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> Vuex.Store(&#123;</div><div class="line">  modules: &#123;</div><div class="line">    module1,</div><div class="line">    module2</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>这里面 <code>module1</code> 和 <code>module2</code> 各自有的 <em>State</em>，子模块的初始状态是作为底层 <code>state</code> 的子树的。在所有子模块上定义的 <em>Mutation</em> 都只能改变当前相关子模块上的 <code>state</code> 子树。</p>
<h3 id="Getters"><a href="#Getters" class="headerlink" title="Getters"></a>Getters</h3><p><em>Getters</em> 是用来获取 <code>state</code> 中的数据的。好像就这么简单……</p>
<p>为什么要有它？共享！如果多个组件都会使用同一个 <code>getter</code>，是很高效的，因为它会被缓存，而且当它所依赖的状态发生改变的时候，相应的 <code>getter</code> 只会被计算一遍。</p>
<h3 id="Mutation"><a href="#Mutation" class="headerlink" title="Mutation"></a>Mutation</h3><p>它就是一个事件系统，按照惯例 <code>mutation</code> 用全大写命名。它不能直接被调用，而需要用 <code>dispatch</code> 的方式来触发：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ...</span></div><div class="line">  mutations: &#123;</div><div class="line">    MUTATION (state, para) &#123;</div><div class="line">      <span class="comment">// ...</span></div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line">store.dispatch(<span class="string">'MUTATION'</span>)</div></pre></td></tr></table></figure>
<p>所有的 <em>Mutation</em> 的第一个参数永远为所属 <code>store</code> 的整个 <code>state</code> 对象。</p>
<p>注意：<em>Mutation</em> 必须是同步函数！如果在它里面进行异步操作，对于状态的控制将会空前混乱。</p>
<h3 id="Actions"><a href="#Actions" class="headerlink" title="Actions"></a>Actions</h3><p>那么想要进行异步操作的话，应该要把异步的行为放在 <em>Actions</em> 里面。<em>actions</em> 就是用于分发 <em>Mutation</em> 的。</p>
<p>在组件中，需要将 <em>Actions</em> 暴露到组件方法中去，让组件觉得个它自己本身的 <em>methods</em> 没有差别。</p>
<h2 id="一些规则"><a href="#一些规则" class="headerlink" title="一些规则"></a>一些规则</h2><ol>
<li>应用 <code>state</code> 存在于单个对象中；</li>
<li>只有 <code>mutation handlers</code> 可以改变 <code>state</code>；</li>
<li><em>Mutations</em> 必须是同步的，它们做的应该仅仅是改变 <code>state</code>；</li>
<li>所有类似数据获取的异步操作细节都应封装在 <code>actions</code> 里面。</li>
<li>组件通过 <code>getters</code> 从 <code>store</code> 中获取 <code>state</code>，并通过调用 <code>actions</code> 来改变 <code>state</code>。</li>
</ol>
<p>Vuex 的主要内容基本上就这些，关于细节方面不多说了。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/08/vue-js-study/" itemprop="url">
                  Vue.js 读书笔记
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-09-08T22:44:07+08:00" content="2016-09-08">
              2016-09-08
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近学习了一下Vue，感觉和React和Angular很像，Angular2也是在往组件化的方向上走，看来这是前端的一个大趋势啊，不禁想起当年拖控件的时代啊，哈哈哈。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.jpeg"
               alt="wenhao" />
          <p class="site-author-name" itemprop="name">wenhao</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">4</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">6</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              友情链接
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://imchenkun.com/" title="sudo rm -rf" target="_blank">sudo rm -rf</a>
                </li>
              
            </ul>
          </div>
        

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">wenhao</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  



  




  
  

  

  

  

</body>
</html>
